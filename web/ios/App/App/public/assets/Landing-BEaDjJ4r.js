import{j as e,m as u,S as E,A,M as z}from"./ui-vendor-DequXtLf.js";import{r as o,u as R}from"./react-vendor-M7dDMeuj.js";import{a as w,P as q,S as D,b as I,C as T}from"./ComparisonTray-ClzrLXdo.js";import{I as B,B as h}from"./input-C4EhYCMY.js";import{u as F,a as $}from"./index-BZiTwUF9.js";const M="http://localhost:8000",V=()=>{const[l,p]=o.useState(null),[d,i]=o.useState(!1),[m,n]=o.useState(null),r=o.useCallback(async t=>{i(!0),n(null);try{const a=new URLSearchParams;if(t.query&&a.append("q",t.query),t.category&&a.append("category",t.category),t.chains&&t.chains.length>0&&a.append("chain",t.chains.join(",")),t.store_ids&&t.store_ids.length>0&&a.append("store",t.store_ids.join(",")),t.promo_only&&a.append("promo_only","true"),t.price_min!==void 0&&a.append("price_min",t.price_min.toString()),t.price_max!==void 0&&a.append("price_max",t.price_max.toString()),t.sort&&a.append("sort",t.sort),t.lat!==void 0&&a.append("lat",t.lat.toString()),t.lon!==void 0&&a.append("lon",t.lon.toString()),t.radius_km!==void 0&&a.append("radius_km",t.radius_km.toString()),t.limit!==void 0&&a.append("page_size",t.limit.toString()),t.offset!==void 0&&t.limit!==void 0){const x=Math.floor(t.offset/t.limit)+1;a.append("page",x.toString())}else t.limit!==void 0&&a.append("page","1");const{data:c}=await w.get(`${M}/products`,{params:a});p(c)}catch{n("Failed to load products")}finally{i(!1)}},[]);return{products:l,loading:d,error:m,fetchProducts:r}},K="http://localhost:8000",U=()=>{const[l,p]=o.useState([]),[d,i]=o.useState(!1),[m,n]=o.useState(null),r=o.useCallback(async(t,a=20)=>{i(!0),n(null);try{const c=new URLSearchParams({lat:t.lat.toString(),lon:t.lon.toString(),radius_km:a.toString()}),{data:x}=await w.get(`${K}/stores?${c.toString()}`);p(x.items)}catch(c){n("Failed to load nearby stores"),console.error("Error fetching stores:",c)}finally{i(!1)}},[]);return{stores:l,loading:d,error:m,fetchNearbyStores:r}},O=()=>{const[l,p]=o.useState(""),d=R(),{products:i,loading:m,fetchProducts:n}=V(),{location:r,radiusKm:t,setRadiusKm:a,requestAutoLocation:c,loading:x,error:y}=F(),{stores:g,loading:S,fetchNearbyStores:j}=U(),{compare:b,toggleCompare:N,clearCompare:_,isAtLimit:C,maxCompare:P}=$();o.useEffect(()=>{r&&!S&&j(r,t)},[r,t,j]),o.useEffect(()=>{n(r?{promo_only:!0,limit:10,lat:r.lat,lon:r.lon,radius_km:t}:{promo_only:!0,limit:10})},[r,t,n]);const v=i!=null&&i.items?i.items.filter(s=>s.price.promo_price_nzd&&s.price.promo_price_nzd<s.price.price_nzd).map(s=>({...s,discountPercent:(s.price.price_nzd-(s.price.promo_price_nzd||0))/s.price.price_nzd*100})).sort((s,L)=>L.discountPercent-s.discountPercent).slice(0,10):[],f=()=>{l.trim()&&d(`/explore?q=${encodeURIComponent(l)}`)},k=()=>{d("/explore?promo_only=true")};return e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx("section",{className:"bg-white",children:e.jsxs("div",{className:"max-w-5xl mx-auto px-6 py-32 text-center",children:[e.jsx(u.h1,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-6xl md:text-7xl font-semibold mb-6 text-primary-gray tracking-tight leading-[1.1]",children:"Find Better Prices"}),e.jsx(u.p,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"text-2xl mb-16 max-w-xl mx-auto text-secondary-gray font-normal",children:"Compare liquor prices across New Zealand's top retailers"}),e.jsx(u.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},className:"max-w-2xl mx-auto",children:e.jsxs("div",{className:"relative group",children:[e.jsx(E,{className:"absolute left-6 top-1/2 transform -translate-y-1/2 h-5 w-5 text-tertiary-gray group-focus-within:text-primary transition-colors"}),e.jsx(B,{placeholder:"Search for beer, wine, or spirits",value:l,onChange:s=>p(s.target.value),onKeyDown:s=>s.key==="Enter"&&f(),className:"pl-16 pr-32 py-8 text-lg rounded-2xl border-2 border-border bg-white focus:border-primary focus:ring-0 transition-all"}),e.jsx(h,{onClick:f,className:"absolute right-2 top-1/2 -translate-y-1/2 bg-primary hover:bg-accent text-white px-8 py-5 text-base font-medium rounded-xl shadow-none",children:"Search"})]})})]})}),e.jsxs("main",{className:"max-w-7xl mx-auto px-6",children:[e.jsx("section",{className:"py-24",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex items-end justify-between mb-12",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-5xl font-semibold text-primary-gray mb-3",children:r?"Deals Near You":"Top Deals"}),!r&&e.jsx("p",{className:"text-lg text-tertiary-gray",children:"Enable location for personalized deals"})]}),e.jsxs(h,{onClick:k,variant:"ghost",className:"text-primary hover:text-accent hover:bg-transparent font-medium text-lg",children:["View All",e.jsx(A,{className:"ml-2 h-5 w-5"})]})]}),e.jsx(q,{products:v,loading:m,compareIds:b.map(s=>s.id),onToggleCompare:N,isCompareAtLimit:C}),!m&&v.length===0&&e.jsx("div",{className:"text-center py-20",children:e.jsx("p",{className:"text-xl text-tertiary-gray",children:"No deals available at the moment"})})]})}),e.jsx("section",{className:"py-24",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-16",children:[e.jsx("h2",{className:"text-5xl font-semibold mb-4 text-primary-gray",children:"Stores Near You"}),e.jsx("p",{className:"text-xl max-w-2xl mx-auto text-secondary-gray",children:"Find local deals from nearby retailers"})]}),!r&&e.jsxs("div",{className:"max-w-2xl mx-auto text-center py-20",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 rounded-full bg-secondary mb-8",children:e.jsx(z,{className:"h-10 w-10 text-primary"})}),e.jsx("h3",{className:"text-3xl font-semibold mb-4 text-primary-gray",children:"Enable Location"}),e.jsx("p",{className:"text-xl mb-10 max-w-md mx-auto text-secondary-gray",children:"See deals from stores in your area"}),e.jsx(h,{onClick:c,disabled:x,size:"lg",className:"bg-primary hover:bg-accent text-white px-10 py-6 text-lg font-medium rounded-xl",children:x?"Getting Location...":"Enable Location"}),y&&e.jsx("p",{className:"text-destructive mt-6 text-base",children:y})]}),r&&e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:"bg-secondary rounded-2xl p-8",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-xl font-medium text-primary-gray",children:"Search Radius"}),e.jsxs("span",{className:"text-3xl font-semibold text-primary",children:[t," km"]})]}),e.jsx(D,{value:[t],onValueChange:s=>a(s[0]),min:5,max:50,step:5,className:"w-full"}),e.jsxs("div",{className:"flex justify-between text-base text-tertiary-gray",children:[e.jsx("span",{children:"5km"}),e.jsxs("span",{children:[g.length," stores"]}),e.jsx("span",{children:"50km"})]})]})}),e.jsx("div",{className:"rounded-2xl overflow-hidden border border-border",children:e.jsx(I,{userLocation:r,stores:g,selectedStore:null,onStoreClick:()=>{},radiusKm:t})})]})]})}),e.jsx("section",{className:"py-32",children:e.jsx("div",{className:"max-w-5xl mx-auto",children:e.jsxs(u.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.6},className:"text-center",children:[e.jsx("h2",{className:"text-5xl md:text-6xl font-semibold mb-6 text-primary-gray tracking-tight",children:"Transparent Pricing"}),e.jsx("p",{className:"text-2xl leading-relaxed text-secondary-gray max-w-2xl mx-auto mb-20",children:"Compare prices across major retailers in real-time"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-12 max-w-4xl mx-auto mb-20",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-6xl font-semibold text-primary mb-3",children:"10+"}),e.jsx("div",{className:"text-lg text-secondary-gray",children:"Retailers"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-6xl font-semibold text-primary mb-3",children:"Live"}),e.jsx("div",{className:"text-lg text-secondary-gray",children:"Prices"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-6xl font-semibold text-primary mb-3",children:"Free"}),e.jsx("div",{className:"text-lg text-secondary-gray",children:"Always"})]})]}),e.jsxs("div",{className:"bg-secondary/50 rounded-2xl p-10 max-w-3xl mx-auto border border-border/50",children:[e.jsx("p",{className:"text-base text-primary-gray font-medium mb-3",children:"Drink Responsibly"}),e.jsxs("p",{className:"text-sm text-secondary-gray leading-relaxed",children:["This platform is an informational tool only. You must be 18+ to purchase alcohol. If you need support, visit ",e.jsx("a",{href:"https://www.alcohol.org.nz",target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:text-accent transition-colors",children:"Alcohol.org.nz"})," or call 0800 787 797."]})]})]})})})]}),e.jsx(T,{products:b,onClear:_,onRemoveProduct:N,maxCompare:P})]})};export{O as Landing,O as default};
