import{r as e}from"./index-Coi2vgDx.js";import{i as b,a as d}from"./productParams-DSKcz1WG.js";const h="http://localhost:8000",E=()=>{const[p,a]=e.useState(null),[f,u]=e.useState(!1),[g,c]=e.useState(null),n=e.useRef(null),o=e.useRef(0),m=e.useCallback(async t=>{var l;o.current+=1;const s=o.current;(l=n.current)==null||l.abort();const i=new AbortController;n.current=i,u(!0),c(null);try{const r=b(t);if(t.limit!==void 0&&r.append("page_size",t.limit.toString()),t.offset!==void 0&&t.limit!==void 0){const S=Math.floor(t.offset/t.limit)+1;r.append("page",S.toString())}else t.limit!==void 0&&r.append("page","1");const{data:P}=await d.get(`${h}/products`,{params:r,signal:i.signal});if(s!==o.current)return;a(P)}catch(r){if(d.isCancel(r)||s!==o.current)return;c("Failed to load products"),a(null)}finally{s===o.current&&u(!1)}},[]);return e.useEffect(()=>()=>{var t;(t=n.current)==null||t.abort()},[]),{products:p,loading:f,error:g,fetchProducts:m}};export{E as u};
