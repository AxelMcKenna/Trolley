import{j as d,c as C,r as b}from"./react-vendor-DRgtYQPK.js";import{M as At,S as bt,L as Y,a as I,P as Ct}from"./map-vendor-CjvMc6d-.js";import{e as jt,N as vt,M as Mt}from"./ui-vendor-CBOXGLFg.js";import{f as K,l as $,m as Pt}from"./index-CCG829II.js";import"./radix-vendor-D8ftTHn1.js";const Lt={super_liquor:"#0066cc",liquorland:"#50b848",countdown:"#00984f",new_world:"#e11a2c",paknsave:"#ffd600",bottle_o:"#00984f",liquor_centre:"#84cfca",glengarry:"#111111",thirsty_liquor:"#f6861e",black_bull:"#111827",big_barrel:"#431717"},tt=r=>Lt[r]||"#6b7280",Et="data:image/png;base64,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",rt=({className:r="h-4 w-4"})=>d.jsx("img",{src:Et,alt:"Super Liquor logo",className:r,style:{objectFit:"contain"}});C.memo(rt);const St="/assets/liquorland-Bvduh_jZ.svg",it=({className:r="h-4 w-4"})=>d.jsx("img",{src:St,alt:"Liquorland logo",className:r,style:{objectFit:"contain"}});C.memo(it);const Tt="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20220%20200'%3e%3clinearGradient%20id='a'%20x1='202.0158'%20x2='132.4334'%20y1='58.2214'%20y2='74.4565'%20gradientTransform='matrix(1%200%200%20-1%200%20221.0523)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='.121'%20stop-color='%2300984f'/%3e%3cstop%20offset='.318'%20stop-color='%232ea751'/%3e%3cstop%20offset='.645'%20stop-color='%2373be53'/%3e%3cstop%20offset='.881'%20stop-color='%239fcc54'/%3e%3cstop%20offset='1'%20stop-color='%23b0d255'/%3e%3c/linearGradient%3e%3cpath%20fill='url(%23a)'%20d='M151.8%20168.5c-5%200-9.6-.7-14.1-1.8-7.3%2010-16.8%2018.7-27.6%2024.6%209.6%205.3%2020.4%208.4%2032.1%208.4%2044.3%200%2074.5-46%2078-85.3-1.6%205.3-10.6%2054.1-68.4%2054.1z'/%3e%3clinearGradient%20id='b'%20x1='175.8478'%20x2='175.8478'%20y1='208.5217'%20y2='51.4676'%20gradientTransform='matrix(1%200%200%20-1%200%20221.0523)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0'%20stop-color='%2307a84d'/%3e%3cstop%20offset='.129'%20stop-color='%2336b44f'/%3e%3cstop%20offset='.269'%20stop-color='%2361be51'/%3e%3cstop%20offset='.405'%20stop-color='%2383c753'/%3e%3cstop%20offset='.533'%20stop-color='%239ccd54'/%3e%3cstop%20offset='.65'%20stop-color='%23abd155'/%3e%3cstop%20offset='.747'%20stop-color='%23b0d255'/%3e%3c/linearGradient%3e%3cpath%20fill='url(%23b)'%20d='M162.9%2046.1c-21.3%200-31.5%2012.3-31.5%2012.3%2022.1%202.2%2049%2017.7%2049%2049.8%200%2031.3-20.4%2045.3-37.2%2050.1-1.6%202.8-3.4%205.7-5.4%208.3%204.5%201.1%209.2%201.8%2014.1%201.8%2057.8%200%2066.9-48.7%2068.2-53.9.3-2.6.4-5.3.4-7.7-.1-43.9-33.7-60.7-57.6-60.7z'/%3e%3clinearGradient%20id='c'%20x1='49.6814'%20x2='49.6814'%20y1='208.5217'%20y2='51.4676'%20gradientTransform='matrix(1%200%200%20-1%200%20221.0523)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0'%20stop-color='%2307a84d'/%3e%3cstop%20offset='.129'%20stop-color='%2336b44f'/%3e%3cstop%20offset='.269'%20stop-color='%2361be51'/%3e%3cstop%20offset='.405'%20stop-color='%2383c753'/%3e%3cstop%20offset='.533'%20stop-color='%239ccd54'/%3e%3cstop%20offset='.65'%20stop-color='%23abd155'/%3e%3cstop%20offset='.747'%20stop-color='%23b0d255'/%3e%3c/linearGradient%3e%3cpath%20fill='url(%23c)'%20d='M68.2%20168.5c12.3%200%2023-3.8%2031.5-9.7-3%20.9-6.5%201.6-10.2%201.6-16.2%200-49.8-12-49.8-52%200-32.1%2027.1-47.7%2049-49.8%200%200-10.3-12.3-31.5-12.3C33.2%2046.2-.4%2063-.4%20107c0%202.6.1%205.1.4%207.7%201.4%205%2010.3%2053.8%2068.2%2053.8z'/%3e%3clinearGradient%20id='d'%20x1='88.2623'%20x2='88.2623'%20y1='135.2275'%20y2='58.7249'%20gradientTransform='matrix(1%200%200%20-1%200%20221.0523)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='.187'%20stop-color='%2300984f'/%3e%3cstop%20offset='.451'%20stop-color='%234cb152'/%3e%3cstop%20offset='.78'%20stop-color='%23b0d255'/%3e%3c/linearGradient%3e%3cpath%20fill='url(%23d)'%20d='M89.6%20160.3c3.7%200%207.2-.7%2010.2-1.6%203.9-2.7%207.4-6%2010.4-9.6-2-2.6-11.5-15.3-11.5-32.5%200-16%208.5-22.9%2011.4-24.6-6-4.3-12.5-5.7-16.2-5.7-6.1%200-22.5%204.2-26.4%2022.9-.1.8-.3%201.5-.4%202.3-.4%203.1-.7%206.5-.7%2010.3%200%2015%206.4%2028.6%2011.4%2036.7%204.4%201.3%208.4%201.8%2011.8%201.8z'/%3e%3clinearGradient%20id='e'%20x1='58.5777'%20x2='116.357'%20y1='29.4079'%20y2='247.3725'%20gradientTransform='matrix(1%200%200%20-1%200%20221.0523)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='.055'%20stop-color='%2300984f'/%3e%3cstop%20offset='.093'%20stop-color='%23159f50'/%3e%3cstop%20offset='.201'%20stop-color='%234cb152'/%3e%3cstop%20offset='.302'%20stop-color='%2377bf53'/%3e%3cstop%20offset='.393'%20stop-color='%2396c954'/%3e%3cstop%20offset='.469'%20stop-color='%23a9d055'/%3e%3cstop%20offset='.522'%20stop-color='%23b0d255'/%3e%3c/linearGradient%3e%3cpath%20fill='url(%23e)'%20d='M110.3%2071.5c-26.8%200-39.5%2019.6-42.9%2037.8%203.9-18.7%2020.3-22.9%2026.4-22.9%203.8%200%2010.4%201.2%2016.2%205.7%206.4%204.7%2011.9%2012.9%2011.9%2025.7%200%2011-4.3%2022.2-11.8%2031.4-9.5%2011.4-24.1%2019.4-42%2019.4-57.9%200-66.9-48.7-68.2-53.9C3.5%20153.8%2033.7%20200%2078%20200c43.2%200%2076.3-43.7%2076.3-80.3-.1-25.6-14.5-48.2-44-48.2z'/%3e%3clinearGradient%20id='f'%20x1='100.5033'%20x2='167.2767'%20y1='157.9081'%20y2='223.8206'%20gradientTransform='matrix(1%200%200%20-1%200%20221.0523)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0'%20stop-color='%235cb249'/%3e%3cstop%20offset='.524'%20stop-color='%238ac450'/%3e%3cstop%20offset='1'%20stop-color='%23b0d255'/%3e%3c/linearGradient%3e%3cpath%20fill='url(%23f)'%20d='M111.1%2056.6s-9.2-8.9-9.9-21c-.4-8.8%203.1-22.2%2017.1-29.8%2032.6-17.5%2060.9%208%2057.7%2024.4%200%200-24.2-11.1-46.7%202.2-16.5%209.8-18.2%2024.2-18.2%2024.2z'/%3e%3c/svg%3e",ct=({className:r="h-4 w-4"})=>d.jsx("img",{src:Tt,alt:"Countdown logo",className:r,style:{objectFit:"contain"}});C.memo(ct);const Ft="data:image/svg+xml,%3csvg%20viewBox='0%200%2060%2045'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20fill-rule='nonzero'%20fill='none'%3e%3cpath%20d='M59.25%2019.523a6.116%206.116%200%200%200-1.962-2.253L35.295%201.96A8.817%208.817%200%200%200%2030.23.37c-1.82%200-3.57.55-5.065%201.59L3.175%2017.27a6.138%206.138%200%200%200-1.965%202.253%206.17%206.17%200%200%200-.654%202.758c0%20.957.228%201.912.654%202.759a6.159%206.159%200%200%200%201.965%202.254l21.99%2015.311a8.822%208.822%200%200%200%205.065%201.59c1.82%200%203.573-.55%205.065-1.59l21.993-15.31a6.137%206.137%200%200%200%201.963-2.255%206.139%206.139%200%200%200%200-5.517'%20fill='%23231F20'/%3e%3cpath%20d='M35.026%2037.793c.37-.568.762-1.223%201.166-1.972.687-1.275%201.28-2.599%201.777-3.957h5.573l-8.516%205.93Zm-3.77%201.49v-7.42h4.517c-1.412%203.564-3.301%206.228-4.517%207.42Zm-2.051%200c-1.216-1.19-3.106-3.854-4.517-7.42h4.517v7.42Zm-12.286-7.42h5.571a30.58%2030.58%200%200%200%201.777%203.958%2028.41%2028.41%200%200%200%201.166%201.97l-8.514-5.927Zm8.51-25.088c-.368.567-.76%201.22-1.162%201.965a30.348%2030.348%200%200%200-1.777%203.96H16.92l8.51-5.925Zm3.776-1.496v7.42h-4.52c1.414-3.567%203.304-6.229%204.52-7.42Zm2.051.002c1.218%201.191%203.106%203.853%204.517%207.418h-4.517V5.281Zm12.286%207.418H37.97a30.098%2030.098%200%200%200-1.777-3.96c-.402-.744-.794-1.4-1.164-1.966l8.514%205.926Zm12.572%206.254L34.122%203.642a6.813%206.813%200%200%200-7.783%200L4.35%2018.952c-2.32%201.615-2.32%205.044%200%206.66l21.99%2015.311a6.813%206.813%200%200%200%207.783%200l21.992-15.311c2.32-1.616%202.32-5.045%200-6.66Z'%20fill='%23FFF'/%3e%3cpath%20d='M42.312%2027.296H38.6l-1.672-5.74-1.673%205.74h-3.5l-2.76-10.027h3.442l1.45%205.924%201.59-5.924h3.21l1.662%206.19%201.583-6.19%203.16.002-2.779%2010.025Zm-14.442-.002h-3.305l-4.91-6.25v6.25h-2.992V17.267l3.91.002%204.32%205.666.002-5.666h2.975v10.025Zm27.07-6.659-8.452-5.884H13.975L5.52%2020.635c-.546.381-.859.982-.859%201.647%200%20.666.313%201.267.86%201.646l8.453%205.886h32.513l8.451-5.886c.548-.38.861-.98.861-1.646a1.98%201.98%200%200%200-.86-1.647Z'%20fill='%23E11A2C'/%3e%3c/g%3e%3c/svg%3e",at=({className:r="h-4 w-4"})=>d.jsx("img",{src:Ft,alt:"New World logo",className:r,style:{objectFit:"contain"}});C.memo(at);const Zt="/assets/paknsave-ClmodRAX.svg",lt=({className:r="h-4 w-4"})=>d.jsx("img",{src:Zt,alt:"PAK'nSAVE logo",className:r,style:{objectFit:"contain"}});C.memo(lt);const _t="/assets/bottle_o-B8Ybatgt.png",ht=({className:r="h-4 w-4"})=>d.jsx("img",{src:_t,alt:"Bottle-O logo",className:r,style:{objectFit:"contain"}});C.memo(ht);const Gt="/assets/liquor_centre-e3MHxJCx.png",pt=({className:r="h-4 w-4"})=>d.jsx("img",{src:Gt,alt:"Liquor Centre",className:r,style:{objectFit:"contain"}});C.memo(pt);const Bt="/assets/glengarry-DkhtuzEK.png",dt=({className:r="h-4 w-4"})=>d.jsx("img",{src:Bt,alt:"Glengarry logo",className:r,style:{objectFit:"contain"}});C.memo(dt);const Ut="/assets/thirsty_liquor-De4io-El.png",ut=({className:r="h-4 w-4"})=>d.jsx("img",{src:Ut,alt:"Thirsty Liquor logo",className:r,style:{objectFit:"contain"}});C.memo(ut);const Nt="/assets/black_bull-C7Z1u-2N.png",ft=({className:r="h-4 w-4"})=>d.jsx("img",{src:Nt,alt:"Black Bull logo",className:r,style:{objectFit:"contain"}});C.memo(ft);const qt="/assets/big_barrel-C_wLqoqi.jpeg",gt=({className:r="h-4 w-4"})=>d.jsx("img",{src:qt,alt:"Big Barrel logo",className:r,style:{objectFit:"contain"}});C.memo(gt);const H=({chain:r,className:t,color:e})=>{const i={super_liquor:rt,liquorland:it,countdown:ct,new_world:at,paknsave:lt,bottle_o:ht,liquor_centre:pt,glengarry:dt,thirsty_liquor:ut,black_bull:ft,big_barrel:gt}[r];return i?d.jsx(i,{className:t,color:e}):d.jsx(jt,{className:t,style:{color:e}})};C.memo(H);const et=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],D=1,_=8;class W{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[e,o]=new Uint8Array(t,0,2);if(e!==219)throw new Error("Data does not appear to be in a KDBush format.");const i=o>>4;if(i!==D)throw new Error(`Got v${i} data when expected v${D}.`);const n=et[o&15];if(!n)throw new Error("Unrecognized array type.");const[c]=new Uint16Array(t,2,1),[a]=new Uint32Array(t,4,1);return new W(a,c,n,t)}constructor(t,e=64,o=Float64Array,i){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+e,2),65535),this.ArrayType=o,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const n=et.indexOf(this.ArrayType),c=t*2*this.ArrayType.BYTES_PER_ELEMENT,a=t*this.IndexArrayType.BYTES_PER_ELEMENT,s=(8-a%8)%8;if(n<0)throw new Error(`Unexpected typed array class: ${o}.`);i&&i instanceof ArrayBuffer?(this.data=i,this.ids=new this.IndexArrayType(this.data,_,t),this.coords=new this.ArrayType(this.data,_+a+s,t*2),this._pos=t*2,this._finished=!0):(this.data=new ArrayBuffer(_+c+a+s),this.ids=new this.IndexArrayType(this.data,_,t),this.coords=new this.ArrayType(this.data,_+a+s,t*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(D<<4)+n]),new Uint16Array(this.data,2,1)[0]=e,new Uint32Array(this.data,4,1)[0]=t)}add(t,e){const o=this._pos>>1;return this.ids[o]=o,this.coords[this._pos++]=t,this.coords[this._pos++]=e,o}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return R(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,e,o,i){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:n,coords:c,nodeSize:a}=this,s=[0,n.length-1,0],p=[];for(;s.length;){const h=s.pop()||0,l=s.pop()||0,u=s.pop()||0;if(l-u<=a){for(let g=u;g<=l;g++){const x=c[2*g],A=c[2*g+1];x>=t&&x<=o&&A>=e&&A<=i&&p.push(n[g])}continue}const f=u+l>>1,m=c[2*f],w=c[2*f+1];m>=t&&m<=o&&w>=e&&w<=i&&p.push(n[f]),(h===0?t<=m:e<=w)&&(s.push(u),s.push(f-1),s.push(1-h)),(h===0?o>=m:i>=w)&&(s.push(f+1),s.push(l),s.push(1-h))}return p}within(t,e,o){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:i,coords:n,nodeSize:c}=this,a=[0,i.length-1,0],s=[],p=o*o;for(;a.length;){const h=a.pop()||0,l=a.pop()||0,u=a.pop()||0;if(l-u<=c){for(let g=u;g<=l;g++)ot(n[2*g],n[2*g+1],t,e)<=p&&s.push(i[g]);continue}const f=u+l>>1,m=n[2*f],w=n[2*f+1];ot(m,w,t,e)<=p&&s.push(i[f]),(h===0?t-o<=m:e-o<=w)&&(a.push(u),a.push(f-1),a.push(1-h)),(h===0?t+o>=m:e+o>=w)&&(a.push(f+1),a.push(l),a.push(1-h))}return s}}function R(r,t,e,o,i,n){if(i-o<=e)return;const c=o+i>>1;mt(r,t,c,o,i,n),R(r,t,e,o,c-1,1-n),R(r,t,e,c+1,i,1-n)}function mt(r,t,e,o,i,n){for(;i>o;){if(i-o>600){const p=i-o+1,h=e-o+1,l=Math.log(p),u=.5*Math.exp(2*l/3),f=.5*Math.sqrt(l*u*(p-u)/p)*(h-p/2<0?-1:1),m=Math.max(o,Math.floor(e-h*u/p+f)),w=Math.min(i,Math.floor(e+(p-h)*u/p+f));mt(r,t,e,m,w,n)}const c=t[2*e+n];let a=o,s=i;for(G(r,t,o,e),t[2*i+n]>c&&G(r,t,o,i);a<s;){for(G(r,t,a,s),a++,s--;t[2*a+n]<c;)a++;for(;t[2*s+n]>c;)s--}t[2*o+n]===c?G(r,t,o,s):(s++,G(r,t,s,i)),s<=e&&(o=s+1),e<=s&&(i=s-1)}}function G(r,t,e,o){z(r,e,o),z(t,2*e,2*o),z(t,2*e+1,2*o+1)}function z(r,t,e){const o=r[t];r[t]=r[e],r[e]=o}function ot(r,t,e,o){const i=r-e,n=t-o;return i*i+n*n}const Ot={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:r=>r},st=Math.fround||(r=>t=>(r[0]=+t,r[0]))(new Float32Array(1)),T=2,S=3,Q=4,E=5,wt=6;class kt{constructor(t){this.options=Object.assign(Object.create(Ot),t),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(t){const{log:e,minZoom:o,maxZoom:i}=this.options;e&&console.time("total time");const n=`prepare ${t.length} points`;e&&console.time(n),this.points=t;const c=[];for(let s=0;s<t.length;s++){const p=t[s];if(!p.geometry)continue;const[h,l]=p.geometry.coordinates,u=st(N(h)),f=st(q(l));c.push(u,f,1/0,s,-1,1),this.options.reduce&&c.push(0)}let a=this.trees[i+1]=this._createTree(c);e&&console.timeEnd(n);for(let s=i;s>=o;s--){const p=+Date.now();a=this.trees[s]=this._createTree(this._cluster(a,s)),e&&console.log("z%d: %d clusters in %dms",s,a.numItems,+Date.now()-p)}return e&&console.timeEnd("total time"),this}getClusters(t,e){let o=((t[0]+180)%360+360)%360-180;const i=Math.max(-90,Math.min(90,t[1]));let n=t[2]===180?180:((t[2]+180)%360+360)%360-180;const c=Math.max(-90,Math.min(90,t[3]));if(t[2]-t[0]>=360)o=-180,n=180;else if(o>n){const l=this.getClusters([o,i,180,c],e),u=this.getClusters([-180,i,n,c],e);return l.concat(u)}const a=this.trees[this._limitZoom(e)],s=a.range(N(o),q(c),N(n),q(i)),p=a.data,h=[];for(const l of s){const u=this.stride*l;h.push(p[u+E]>1?nt(p,u,this.clusterProps):this.points[p[u+S]])}return h}getChildren(t){const e=this._getOriginId(t),o=this._getOriginZoom(t),i="No cluster with the specified id.",n=this.trees[o];if(!n)throw new Error(i);const c=n.data;if(e*this.stride>=c.length)throw new Error(i);const a=this.options.radius/(this.options.extent*Math.pow(2,o-1)),s=c[e*this.stride],p=c[e*this.stride+1],h=n.within(s,p,a),l=[];for(const u of h){const f=u*this.stride;c[f+Q]===t&&l.push(c[f+E]>1?nt(c,f,this.clusterProps):this.points[c[f+S]])}if(l.length===0)throw new Error(i);return l}getLeaves(t,e,o){e=e||10,o=o||0;const i=[];return this._appendLeaves(i,t,e,o,0),i}getTile(t,e,o){const i=this.trees[this._limitZoom(t)],n=Math.pow(2,t),{extent:c,radius:a}=this.options,s=a/c,p=(o-s)/n,h=(o+1+s)/n,l={features:[]};return this._addTileFeatures(i.range((e-s)/n,p,(e+1+s)/n,h),i.data,e,o,n,l),e===0&&this._addTileFeatures(i.range(1-s/n,p,1,h),i.data,n,o,n,l),e===n-1&&this._addTileFeatures(i.range(0,p,s/n,h),i.data,-1,o,n,l),l.features.length?l:null}getClusterExpansionZoom(t){let e=this._getOriginZoom(t)-1;for(;e<=this.options.maxZoom;){const o=this.getChildren(t);if(e++,o.length!==1)break;t=o[0].properties.cluster_id}return e}_appendLeaves(t,e,o,i,n){const c=this.getChildren(e);for(const a of c){const s=a.properties;if(s&&s.cluster?n+s.point_count<=i?n+=s.point_count:n=this._appendLeaves(t,s.cluster_id,o,i,n):n<i?n++:t.push(a),t.length===o)break}return n}_createTree(t){const e=new W(t.length/this.stride|0,this.options.nodeSize,Float32Array);for(let o=0;o<t.length;o+=this.stride)e.add(t[o],t[o+1]);return e.finish(),e.data=t,e}_addTileFeatures(t,e,o,i,n,c){for(const a of t){const s=a*this.stride,p=e[s+E]>1;let h,l,u;if(p)h=xt(e,s,this.clusterProps),l=e[s],u=e[s+1];else{const w=this.points[e[s+S]];h=w.properties;const[g,x]=w.geometry.coordinates;l=N(g),u=q(x)}const f={type:1,geometry:[[Math.round(this.options.extent*(l*n-o)),Math.round(this.options.extent*(u*n-i))]],tags:h};let m;p||this.options.generateId?m=e[s+S]:m=this.points[e[s+S]].id,m!==void 0&&(f.id=m),c.features.push(f)}}_limitZoom(t){return Math.max(this.options.minZoom,Math.min(Math.floor(+t),this.options.maxZoom+1))}_cluster(t,e){const{radius:o,extent:i,reduce:n,minPoints:c}=this.options,a=o/(i*Math.pow(2,e)),s=t.data,p=[],h=this.stride;for(let l=0;l<s.length;l+=h){if(s[l+T]<=e)continue;s[l+T]=e;const u=s[l],f=s[l+1],m=t.within(s[l],s[l+1],a),w=s[l+E];let g=w;for(const x of m){const A=x*h;s[A+T]>e&&(g+=s[A+E])}if(g>w&&g>=c){let x=u*w,A=f*w,j,M=-1;const Z=((l/h|0)<<5)+(e+1)+this.points.length;for(const O of m){const v=O*h;if(s[v+T]<=e)continue;s[v+T]=e;const B=s[v+E];x+=s[v]*B,A+=s[v+1]*B,s[v+Q]=Z,n&&(j||(j=this._map(s,l,!0),M=this.clusterProps.length,this.clusterProps.push(j)),n(j,this._map(s,v)))}s[l+Q]=Z,p.push(x/g,A/g,1/0,Z,-1,g),n&&p.push(M)}else{for(let x=0;x<h;x++)p.push(s[l+x]);if(g>1)for(const x of m){const A=x*h;if(!(s[A+T]<=e)){s[A+T]=e;for(let j=0;j<h;j++)p.push(s[A+j])}}}}return p}_getOriginId(t){return t-this.points.length>>5}_getOriginZoom(t){return(t-this.points.length)%32}_map(t,e,o){if(t[e+E]>1){const c=this.clusterProps[t[e+wt]];return o?Object.assign({},c):c}const i=this.points[t[e+S]].properties,n=this.options.map(i);return o&&n===i?Object.assign({},n):n}}function nt(r,t,e){return{type:"Feature",id:r[t+S],properties:xt(r,t,e),geometry:{type:"Point",coordinates:[It(r[t]),Dt(r[t+1])]}}}function xt(r,t,e){const o=r[t+E],i=o>=1e4?`${Math.round(o/1e3)}k`:o>=1e3?`${Math.round(o/100)/10}k`:o,n=r[t+wt],c=n===-1?{}:Object.assign({},e[n]);return Object.assign(c,{cluster:!0,cluster_id:r[t+S],point_count:o,point_count_abbreviated:i})}function N(r){return r/360+.5}function q(r){const t=Math.sin(r*Math.PI/180),e=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return e<0?0:e>1?1:e}function It(r){return(r-.5)*360}function Dt(r){const t=(180-r*360)*Math.PI/180;return 360*Math.atan(Math.exp(t))/Math.PI-90}function zt(r){return r.properties.cluster===!0}function Qt(r,t,e){const o=b.useMemo(()=>{const n=new kt({radius:60,maxZoom:16}),c=r.map(a=>({type:"Feature",properties:{cluster:!1,store:a},geometry:{type:"Point",coordinates:[a.lon,a.lat]}}));return n.load(c),n},[r]);return{clusters:b.useMemo(()=>e?o.getClusters(e,Math.floor(t)):[],[o,e,t]),index:o}}const Ht=(r,t)=>{const o={latitude:r[1],longitude:r[0]},i=t,n=[],c=i/(111.32*Math.cos(o.latitude*Math.PI/180)),a=i/110.574;for(let s=0;s<64;s++){const p=s/64*(2*Math.PI),h=c*Math.cos(p),l=a*Math.sin(p);n.push([o.longitude+h,o.latitude+l])}return n.push(n[0]),{type:"Feature",geometry:{type:"Polygon",coordinates:[n]},properties:{}}},Yt=({userLocation:r,stores:t,selectedStore:e=null,radiusKm:o,onLocationChange:i,isDraggable:n=!1})=>{const[c,a]=b.useState(null),[s,p]=b.useState(r),[h,l]=b.useState(null),[u,f]=b.useState({longitude:r.lon,latitude:r.lat,zoom:12}),[m,w]=b.useState(null);b.useEffect(()=>{f({longitude:r.lon,latitude:r.lat,zoom:12}),p(r)},[r]);const g=b.useCallback(y=>{const{lngLat:P}=y,F={lat:P.lat,lon:P.lng};p(F),i&&i(P.lat,P.lng)},[i]),x=b.useCallback(()=>{if(!h)return;const y=h.getBounds();y&&w([y.getWest(),y.getSouth(),y.getEast(),y.getNorth()])},[h]),A=b.useCallback(y=>{f(y.viewState),x()},[x]),j=b.useCallback(()=>{x()},[x]),M=n?s:r,Z=b.useMemo(()=>Ht([M.lon,M.lat],o),[M.lon,M.lat,o]),{clusters:O,index:v}=Qt(t,u.zoom,m),B=b.useCallback((y,P,F)=>{const L=v.getClusterExpansionZoom(y);h==null||h.flyTo({center:[P,F],zoom:L,duration:500})},[v,h]);return d.jsx("div",{className:"w-full h-[500px] rounded-lg overflow-hidden shadow-lg border border-border",children:d.jsxs(At,{ref:l,...u,onMove:A,onLoad:j,mapStyle:"https://basemaps.cartocdn.com/gl/positron-gl-style/style.json",style:{width:"100%",height:"100%"},children:[d.jsxs(bt,{id:"radius",type:"geojson",data:Z,children:[d.jsx(Y,{id:"radius-fill",type:"fill",paint:{"fill-color":"#3b82f6","fill-opacity":.1}}),d.jsx(Y,{id:"radius-outline",type:"line",paint:{"line-color":"#3b82f6","line-width":2,"line-opacity":.6}})]}),d.jsx(I,{longitude:M.lon,latitude:M.lat,anchor:"center",draggable:n,onDragEnd:g,children:d.jsxs("div",{className:"relative",children:[!n&&d.jsx("div",{className:"absolute -inset-2 bg-location rounded-full animate-ping opacity-75"}),d.jsx("div",{className:K("relative bg-location p-2 rounded-full shadow-lg border-2 border-white",n&&"cursor-move"),children:d.jsx(vt,{className:"h-5 w-5 text-white"})})]})}),O.map(y=>{const[P,F]=y.geometry.coordinates;if(zt(y)){const{cluster_id:U,point_count:J}=y.properties,k=Math.min(24+J/t.length*40,56);return d.jsx(I,{longitude:P,latitude:F,anchor:"center",onClick:yt=>{yt.originalEvent.stopPropagation(),B(U,P,F)},children:d.jsx("div",{className:"rounded-full bg-blue-500 text-white flex items-center justify-center font-semibold cursor-pointer shadow-lg border-2 border-white transition-transform hover:scale-110",style:{width:`${k}px`,height:`${k}px`,fontSize:`${Math.max(11,k*.35)}px`},children:J})},`cluster-${U}`)}const L=y.properties.store,V=tt(L.chain),X=(e==null?void 0:e.id)===L.id;return d.jsx(I,{longitude:L.lon,latitude:L.lat,anchor:"bottom",onClick:U=>{U.originalEvent.stopPropagation(),a(L)},children:d.jsx("div",{className:`cursor-pointer transition-transform hover:scale-110 ${X?"scale-125":""}`,children:d.jsxs("div",{className:"relative",style:{filter:X?"drop-shadow(0 0 8px rgba(34, 197, 94, 0.8))":""},children:[d.jsxs("svg",{width:"46",height:"58",viewBox:"0 0 40 50",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[d.jsx("path",{d:"M20 0C8.95 0 0 8.95 0 20C0 35 20 50 20 50C20 50 40 35 40 20C40 8.95 31.05 0 20 0Z",fill:V}),d.jsx("circle",{cx:"20",cy:"18",r:"10",fill:"white"})]}),d.jsx("div",{className:"absolute top-[8px] left-1/2 transform -translate-x-1/2",children:d.jsx(H,{chain:L.chain,className:"h-5 w-5",color:V})})]})})},L.id)}),c&&d.jsx(Ct,{longitude:c.lon,latitude:c.lat,anchor:"top",onClose:()=>a(null),closeButton:!0,closeOnClick:!1,maxWidth:"280px",children:d.jsxs("div",{className:"p-3 pr-8",children:[d.jsxs("div",{className:"flex items-start gap-2.5 mb-2",children:[d.jsx("div",{className:"p-1.5 rounded shrink-0",style:{backgroundColor:tt(c.chain)},children:d.jsx(H,{chain:c.chain,className:"h-4 w-4 text-white"})}),d.jsxs("div",{className:"min-w-0",children:[d.jsx("h3",{className:"font-semibold text-primary-gray text-sm leading-tight",children:c.name}),d.jsx("p",{className:"text-xs text-secondary-gray mt-0.5 line-clamp-2",children:c.address})]})]}),$(c.distance_km)&&d.jsxs("div",{className:K("flex items-center gap-1 text-xs font-medium",Pt(c.distance_km)),children:[d.jsx(Mt,{className:"h-3.5 w-3.5"}),d.jsxs("span",{children:[$(c.distance_km)," away"]})]})]})})]})})};export{Yt as StoreMap};
